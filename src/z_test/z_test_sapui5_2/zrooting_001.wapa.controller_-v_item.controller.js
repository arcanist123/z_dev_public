sap.ui.define([                                                                                                                                                                                                                                                
	"sap/ui/core/mvc/Controller",                                                                                                                                                                                                                                 
	"sap/ui/core/Fragment"                                                                                                                                                                                                                                        
], function(Controller) {                                                                                                                                                                                                                                      
	"use strict";                                                                                                                                                                                                                                                 
	return Controller.extend("ZROUTING_001.controller.V_Item", {                                                                                                                                                                                                  
		/**                                                                                                                                                                                                                                                          
		 * Called when a controller is instantiated and its View controls (if available) are already created.                                                                                                                                                        
		 * Can be used to modify the View before it is displayed, to bind event handlers and do other one-time initialization.                                                                                                                                       
		 * @memberOf ZROUTING_001.view.V_Item                                                                                                                                                                                                                        
		 */                                                                                                                                                                                                                                                          
		onInit: function() {                                                                                                                                                                                                                                         
			// Get the Router Info                                                                                                                                                                                                                                      
			var oRouter = sap.ui.core.UIComponent.getRouterFor(this);                                                                                                                                                                                                   
			// Validate/Match the Router Details sent from source using oRouter.navTo("Router_Detail", {SelectedItem: selectPO});                                                                                                                                       
			oRouter.getRoute("Target_Item").attachMatched(this._onRouteFound, this);                                                                                                                                                                                    
		},                                                                                                                                                                                                                                                           
		_getDialog: function() {                                                                                                                                                                                                                                     
			// create a fragment with dialog, and pass the selected data                                                                                                                                                                                                
			if (!this.dialog) {                                                                                                                                                                                                                                         
				// This fragment can be instantiated from a controller as follows:                                                                                                                                                                                         
				this.dialog = sap.ui.xmlfragment("idFragment", "ZROUTING_001.view.ShowDetail", this); //debugger;                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
			//debugger;                                                                                                                                                                                                                                                 
			return this.dialog;                                                                                                                                                                                                                                         
		},                                                                                                                                                                                                                                                           
		_onRouteFound: function(oEvt) {                                                                                                                                                                                                                              
			var oArgument = oEvt.getParameter("arguments");                                                                                                                                                                                                             
			var lv_carrid = oArgument.SelectedCarrid;                                                                                                                                                                                                                   
			var oModel = new sap.ui.model.odata.v2.ODataModel("/sap/opu/odata/SAP/ZSLFIGHT_MODEL_SRV/");                                                                                                                                                                
			this.getView().setModel(oModel);                                                                                                                                                                                                                            
			var filters = new sap.ui.model.Filter({                                                                                                                                                                                                                     
				and: true,                                                                                                                                                                                                                                                 
				filters: [new sap.ui.model.Filter("Carrid", sap.ui.model.FilterOperator.EQ, lv_carrid)]                                                                                                                                                                    
			});                                                                                                                                                                                                                                                         
			var binding = this.byId("it_items").getBinding("items");                                                                                                                                                                                                    
			binding.filter(filters);                                                                                                                                                                                                                                    
		},                                                                                                                                                                                                                                                           
		/**                                                                                                                                                                                                                                                          
		 *@memberOf ZROUTING_001.controller.V_Item                                                                                                                                                                                                                   
		 */                                                                                                                                                                                                                                                          
		GoToFirstView: function(oEvent) {                                                                                                                                                                                                                            
			var oRouter = sap.ui.core.UIComponent.getRouterFor(this);                                                                                                                                                                                                   
			oRouter.navTo("Target_Header");                                                                                                                                                                                                                             
		},                                                                                                                                                                                                                                                           
		closeDialog: function() {                                                                                                                                                                                                                                    
			this._getDialog().close();                                                                                                                                                                                                                                  
		},                                                                                                                                                                                                                                                           
		onSave: function() {                                                                                                                                                                                                                                         
			//debugger;                                                                                                                                                                                                                                                 
			var oPersonInfo = sap.ui.getCore().byId("idFragment--idPersNo").getValue();                                                                                                                                                                                 
			var oFirstName = sap.ui.getCore().byId("idFragment--idFirstName").getValue();                                                                                                                                                                               
			var oLastName = sap.ui.getCore().byId("idFragment--idLastName").getValue();                                                                                                                                                                                 
			var oDept = sap.ui.getCore().byId("idFragment--idDepartment").getValue();                                                                                                                                                                                   
			var oEmail = sap.ui.getCore().byId("idFragment--idEMail").getValue();                                                                                                                                                                                       
			var finalData = {                                                                                                                                                                                                                                           
				"PersNo": oPersonInfo,                                                                                                                                                                                                                                     
				"FirstName": oFirstName,                                                                                                                                                                                                                                   
				"LastName": oLastName,                                                                                                                                                                                                                                     
				"Department": oDept,                                                                                                                                                                                                                                       
				"EMail": oEmail                                                                                                                                                                                                                                            
			};                                                                                                                                                                                                                                                          
		},                                                                                                                                                                                                                                                           
		/**                                                                                                                                                                                                                                                          
		 *@memberOf ZROUTING_001.controller.V_Item                                                                                                                                                                                                                   
		 */                                                                                                                                                                                                                                                          
		onItemPress: function(oEvent) {                                                                                                                                                                                                                              
			var oBindingContext = oEvent.getSource().getBindingContext();                                                                                                                                                                                               
			var planetype = oBindingContext.getProperty("Planetype");                                                                                                                                                                                                   
			// get the fragment                                                                                                                                                                                                                                         
			this._getDialog().open();                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
			// get the reference of input fields of fragment and set the values                                                                                                                                                                                         
			sap.ui.getCore().byId("idFragment--idPersNo").setValue(planetype);                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
		}                                                                                                                                                                                                                                                            
	});                                                                                                                                                                                                                                                           
});                                                                                                                                                                                                                                                            